{
	"name": "FT_diaria_optim",
	"properties": {
		"content": {
			"query": "WITH \nTEMP AS (\n    SELECT \n    CAST( time as date ) as fecha\n    , CodigoNAcional as estacion \n    , max(ts_valor) as max_temp \n    , min(ts_valor) as min_temp \n    , max(ts_valor) - min(ts_valor) as var_temp\n    , round( avg(ts_valor),2) as med_temp\n    FROM dbo.temperatura\n    group by CAST( time as date ), CodigoNAcional \n), \nVIENTO AS (\n    SELECT\n    CAST ( time as date) as fecha\n    , CodigoNacional as estacion \n    , MAX(ff_Valor) as max_vvel\n    , MIN(ff_Valor) as min_vvel\n    FROM dbo.viento\n    GROUP by cast( time as date), CodigoNacional\n    ),\nHUMEDAD AS (\n    SELECT\n      CAST ( time as date) as fecha\n    , CodigoNacional as estacion \n    , COALESCE(MAX(HR_Valor),0) AS max_hum\n    , COALESCE(MIN(HR_Valor),0) AS min_hum\n    , COALESCE(ROUND(AVG(HR_Valor),2),0) AS med_hum\n    FROM dbo.humedad\n    GROUP BY CAST( time as date ), CodigoNAcional \n)\n\n\nSELECT \n    COALESCE (t.TIME , h.time , v.time) as fecha_hora,\n    COALESCE (t.CodigoNacional, h.CodigoNacional, v.CodigoNacional) as Codigo,\n    MAX(t.Ts_Valor) AS T_MAX,\n    MIN(t.Ts_Valor) AS T_MIN,\n    h.HR_Valor,\n    v.dd_Valor,\n    v.ff_Valor,\n    v.VRB_Valor\nFROM dbo.temperatura T \n    FULL JOIN dbo.viento V  \n        ON t.time =v.time\n        AND t.CodigoNacional = v.CodigoNacional\n    FULL JOIN dbo.humedad H \n        ON t.time = h.time\n        AND t.CodigoNacional= h.CodigoNacional\nGO",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "master",
				"poolName": "Built-in"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}